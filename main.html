<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="js/mui.min.js"></script>
		<link href="css/mui.min.css" rel="stylesheet" />
		<script type="text/javascript" charset="utf-8">
			mui.init();
		</script>
		<style type="text/css">
			#logo {
				height: 40px;
			}
			#div_username h5 {
				line-height: 40px;
				vertical-align: middle;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<div class="mui-pull-left">
				<img src="images/logo.png" id="logo" />
			</div>
			<div class="mui-pull-right" id="div_username">
				<h5>欢迎您：<span id="username"></span></h5>
			</div>
		</header>
		<div class="mui-content">
			<ul class="mui-table-view mui-grid-view mui-grid-9" id="table_menu">
			</ul>
		</div>
		<script src="js/template.js" type="text/javascript" charset="utf-8"></script>
		<script id="tmpl_menu" type="text/html">
			<li class="mui-table-view-cell mui-media mui-col-xs-4">
				<a href="#">
					<span class="mui-icon">
							<img src="{{iconUrl}}"/>
							{{if count}}
							<span class="mui-badge">{{count}}</span>
							{{/if}}
					</span>
					<div class="mui-media-body">{{name}}</div>
				</a>
			</li>
		</script>
		<script src="js/app.js"></script>
		<script src="js/common.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			mui.plusReady(function() {
				//用户名
				var self = plus.webview.currentWebview();
				document.getElementById("username").innerHTML = self.username;
				//菜单
				var settings = app.getSettings();
				mui.ajax(settings.host + "/third/pda/third_pda_config/thirdPdaConfig.do?method=menuDetail", {
					dataType: "json",
					type: "GET",
					success: function(data) {
						if (data.menus) {
							var tmpl="";
							mui.each(data.menus, function(i, obj) {
								obj.iconUrl=settings.host + iconPath+obj.icon;
								if (obj.countUrl) {
									mui.ajax(settings.host +obj.countUrl,{"async":false,dataType:"json", success:function(countObj) {
										obj.count = countObj.count; 
									}})
								}
								tmpl+=template("tmpl_menu",obj);
							})
							document.getElementById("table_menu").innerHTML=tmpl;
						}
					}
				})
			})
		</script>
	</body>

</html>